<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Jan 9, 2026

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #33 | 6:46 PM | ‚öñÔ∏è | Code Review Security Audit Documentation | ~354 |
| #32 | 6:43 PM | üîµ | React Browser Extension Popup Architecture | ~317 |
</claude-mem-context>

# CLAUDE.md

This file provides guidance to Claude when working with this codebase.

## Project Overview

OmniClipper is a WXT-based browser extension for saving links and notes. The app supports multiple storage backends: local storage, Feishu (È£û‰π¶), and Supabase.

## Code Review Findings

### Security Issues

1. **Hardcoded Supabase Credentials**
   - **File**: [storageService.ts:15-17](services/storageService.ts#L15-L17)
   - **Issue**: Supabase URL and anonKey are hardcoded in `DEFAULT_SETTINGS`
   - **Severity**: High - These credentials should not be committed to version control
   - **Recommendation**: Use environment variables (`import.meta.env`) or a backend proxy

2. **Direct Supabase Auth Calls from Frontend**
   - **File**: [supabaseService.ts:7](services/supabaseService.ts#L7), [supabaseService.ts:28](services/supabaseService.ts#L28)
   - **Issue**: Calling Supabase auth APIs (`/auth/v1/signup`, `/auth/v1/token`) directly from the frontend
   - **Severity**: Medium - Exposes anonKey and increases attack surface
   - **Recommendation**: Route these requests through a backend proxy to hide credentials

### Error Handling Concerns

3. **Silent Failures with Mock Tokens**
   - **File**: [feishuService.ts:31-34](services/feishuService.ts#L31-L34), [feishuService.ts:42-44](services/feishuService.ts#L42-L44)
   - **Issue**: When API calls fail, the code returns mock tokens instead of propagating errors
   - **Severity**: Medium - Makes debugging difficult and may mask real issues in production
   - **Recommendation**: Either throw errors or return a proper Result type; use mock tokens only in development mode with clear logging

### General Guidelines

4. **Type Safety**
   - Use `zod` or similar library for runtime validation of settings loaded from `localStorage`
   - Avoid `any` types in Supabase service responses

5. **CORS Handling**
   - The Feishu service has a comment about CORS proxying (line 3-5). Ensure a proper proxy is implemented before production deployment.

## Tech Stack

- **Framework**: React + TypeScript
- **Build Tool**: Vite / WXT
- **Styling**: Tailwind CSS
- **Storage**: localStorage, Feishu API, Supabase