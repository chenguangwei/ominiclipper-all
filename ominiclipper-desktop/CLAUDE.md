<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Jan 21, 2026

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #905 | 11:48 PM | ğŸ”µ | DocumentViewer Full-Screen vs Preview Functionality Gap Identified | ~355 |
| #837 | 7:21 PM | ğŸ”µ | Found Global PDF.js Worker Configuration in App.tsx | ~255 |
| #822 | 7:13 PM | âœ… | Added Global PDF.js Worker Configuration in App.tsx | ~259 |
| #821 | 7:12 PM | ğŸ”µ | Examined App.tsx Imports and Component Structure | ~314 |
| #820 | " | âš–ï¸ | Global PDF Worker Configuration Strategy | ~387 |
| #808 | 6:40 PM | ğŸ”µ | Located DocumentViewer Component Implementation | ~261 |
| #802 | 6:39 PM | ğŸ”µ | Examined Document Opening Logic in App.tsx | ~312 |
| #800 | " | ğŸ”µ | Investigating Document Opening Functionality | ~266 |
| #796 | 6:36 PM | ğŸ”´ | Comprehensive PDF Worker CDN Dependency Resolution | ~362 |
| #789 | 6:27 PM | ğŸ”´ | Added PDF Worker Development Server Plugin | ~290 |
| #788 | " | ğŸŸ£ | Added Development Mode PDF Worker Plugin | ~290 |
| #785 | 6:26 PM | ğŸ”´ | Confirmed PDF Worker File Successfully Copied to dist | ~277 |
| #779 | 6:22 PM | ğŸ”´ | Fixed PDF Worker Configuration in Vite Build | ~293 |
| #758 | 1:52 PM | âœ… | Vite build configuration manages Electron file copying | ~310 |

### Jan 22, 2026

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #943 | 10:01 AM | âœ… | Documentation Updated - File Recovery Enhancements Documented | ~277 |
| #940 | 10:00 AM | ğŸ”µ | File Expiration Root Cause Identified - EmbeddedData No Longer Used | ~354 |
| #938 | 9:59 AM | ğŸ”µ | File Embedding Mechanism Investigation - Drag and Drop Process | ~345 |
| #931 | 9:49 AM | âœ… | Enhanced Documentation for Folder Migration Feature | ~422 |
| #930 | " | âœ… | Documentation Updated - Recent Changes Section Enhanced | ~303 |
| #929 | " | âœ… | Documentation Updated to Reflect New File Migration Feature | ~372 |
| #924 | 9:47 AM | ğŸ”µ | File Storage Architecture Gap Identified for Embed Mode Migration | ~447 |
| #921 | 9:46 AM | ğŸ”µ | Type System and File Storage Service Analysis | ~363 |
| #920 | " | ğŸŸ£ | Automatic File Migration for Embed Content Mode | ~368 |
| #919 | 9:45 AM | âœ… | Code Structure Documentation Successfully Created | ~453 |
| #918 | 9:44 AM | ğŸ”µ | Omniclipper Desktop Codebase Documentation Successfully Completed | ~418 |
| #917 | 9:43 AM | ğŸ”µ | Omniclipper Desktop Comprehensive Codebase Analysis Completed | ~420 |
| #916 | 9:42 AM | ğŸ”µ | Omniclipper Desktop Comprehensive Architecture Analysis Completed | ~438 |
| #915 | " | ğŸ”µ | Omniclipper Desktop Application Architecture Mapped | ~336 |
| #914 | " | ğŸ”µ | Omniclipper Desktop Application Architecture Mapped | ~312 |
</claude-mem-context>

# OmniClipper Desktop - Development Guide

This document provides guidance for Claude when working with OmniClipper Desktop codebase.

## Project Overview

OmniClipper Desktop is a resource management desktop client built with React + TypeScript + Vite, featuring macOS-native design, multiple view modes, and cloud sync via Supabase.

## Completed Features

All features marked as "å¾…å®ç°" in README.md have been completed:

- [x] æ–‡ä»¶æ‹–æ‹½å¯¼å…¥ - Drag and drop file import
- [x] æ–‡æ¡£å†…å®¹é¢„è§ˆ - Document content preview (Details/Preview tabs)
- [x] å¿«æ·é”®æ”¯æŒ - Keyboard shortcuts (âŒ˜N, âŒ˜F, âŒ˜E, etc.)
- [x] æ•°æ®å¯¼å…¥/å¯¼å‡º UI - Import/Export dialog (JSON/CSV)
- [x] å¤šè¯­è¨€æ”¯æŒ (i18n) - Internationalization (English/Chinese)
- [x] Electron æ¡Œé¢åº”ç”¨æ‰“åŒ… - Electron desktop app packaging
- [x] å®é™…æ–‡ä»¶è·¯å¾„ç®¡ç† - File path management (starred, recent files, file stats)
- [x] æ–‡æ¡£å…¨æ–‡å†…å®¹é¢„è§ˆ - Full document rendering (PDF/EPUB with PDF.js/EPUB.js)
- [x] AI æ™ºèƒ½æ‘˜è¦åŠŸèƒ½ - AI-powered content summarization

### All Features Complete
All planned features from README.md have been implemented. The application now includes:
- Complete resource management (create, edit, delete, organize)
- Multiple view modes (list, table, grid)
- Document preview and rendering (PDF.js, EPUB.js)
- Star/favorite items with filtering
- Recent files tracking and statistics
- AI summarization with one-click generation
- Cloud sync with Supabase
- Electron desktop packaging

## Architecture

```
ominiclipper-desktop/
â”œâ”€â”€ App.tsx                 # Main app component with state management
â”œâ”€â”€ index.tsx               # App entry point
â”œâ”€â”€ index.html              # HTML template
â”œâ”€â”€ types.ts                # TypeScript types
â”œâ”€â”€ constants.ts            # Constants, themes, mock data
â”œâ”€â”€ supabaseClient.ts       # Supabase client
â”œâ”€â”€ vite.config.ts          # Vite configuration
â”œâ”€â”€ package.json            # Project config & Electron builder
â”œâ”€â”€ electron/
â”‚   â”œâ”€â”€ main.js             # Electron main process
â”‚   â””â”€â”€ preload.js          # Preload script for secure IPC
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ storageService.ts   # localStorage operations
â”‚   â”œâ”€â”€ i18n.ts             # Internationalization service
â”‚   â”œâ”€â”€ fileManager.ts      # File path management (starred, recent, stats)
â”‚   â””â”€â”€ documentViewer.ts   # PDF/EPUB rendering service (PDF.js/EPUB.js)
â””â”€â”€ components/
    â”œâ”€â”€ TopBar.tsx          # Top toolbar (search, view switcher, actions)
    â”œâ”€â”€ Sidebar.tsx         # Left sidebar (folders, tags, user)
    â”œâ”€â”€ ListDetailView.tsx  # List detail view
    â”œâ”€â”€ PreviewPane.tsx     # Preview pane with Details/Preview tabs, AI summary
    â”œâ”€â”€ TableView.tsx       # Table view
    â”œâ”€â”€ GridView.tsx        # Grid view
    â”œâ”€â”€ AuthDialog.tsx      # Authentication/settings dialog
    â”œâ”€â”€ ImportExportDialog.tsx  # Import/Export dialog
    â”œâ”€â”€ CreateResourceDialog.tsx    # Create/edit resource dialog with form validation & light/dark mode
    â”‚   â”œâ”€â”€ Props: isOpen, onClose, onSave, tags, folders, editItem (optional), colorMode (required)
    â”‚   â”œâ”€â”€ State: title (required), type (WEB default), path, contentSnippet, selectedTags[], folderId, color (tag-blue default), isCloud
    â”‚   â”œâ”€â”€ RESOURCE_TYPE_OPTIONS: WEB, WORD, PDF, EPUB, IMAGE, UNKNOWN with icons
    â”‚   â”œâ”€â”€ COLOR_OPTIONS: tag-blue, tag-green, tag-orange, tag-red, tag-yellow, tag-purple
    â”‚   â”œâ”€â”€ Features: Resource type grid buttons, URL input (WEB only), folder hierarchy select with recursion, tag toggle buttons, color picker circle buttons, cloud sync toggle, full light/dark mode support
    â”‚   â”œâ”€â”€ Edit Mode: Pre-fills all fields from editItem when provided, resets on close
    â”‚   â””â”€â”€ Validation: Title required, auto-focus on title input
    â”œâ”€â”€ CreateFolderDialog.tsx      # Create/edit folder dialog with light/dark mode
    â”‚   â”œâ”€â”€ Props: isOpen, onClose, onSave, folders, editFolder (optional), colorMode (required)
    â”‚   â””â”€â”€ Features: Name input, parent folder select, icon grid picker (12 icons), full light/dark mode support
    â”œâ”€â”€ CreateTagDialog.tsx         # Create/edit tag dialog with light/dark mode
    â”‚   â”œâ”€â”€ Props: isOpen, onClose, onSave, tags, editTag (optional), colorMode (required)
    â”‚   â””â”€â”€ Features: Name input, parent tag select, color picker (8 colors), live preview, full light/dark mode support
    â”œâ”€â”€ ConfirmDialog.tsx           # Confirmation dialog
    â”œâ”€â”€ DocumentViewer.tsx          # Full document viewer (PDF/EPUB)
    â””â”€â”€ Icon.tsx            # Icon component
```

## Keyboard Shortcuts

| Shortcut | Action |
|----------|--------|
| `âŒ˜/Ctrl + N` | Create new resource |
| `âŒ˜/Ctrl + F` | Focus search |
| `âŒ˜/Ctrl + E` | Open Import/Export dialog |
| `âŒ˜/Ctrl + 1` | Table view |
| `âŒ˜/Ctrl + 2` | List detail view |
| `âŒ˜/Ctrl + 3` | Grid view |
| `Delete` | Delete selected item |
| `Escape` | Close dialogs |
| `â†‘/â†“` | Navigate between items |

## Development Guidelines

### Running the App

1. Development mode:
   ```bash
   cd ominiclipper-desktop
   npm install
   npm run dev
   ```
   Visit http://localhost:3000

2. Build for web:
   ```bash
   npm run build
   ```

3. Run Electron development:
   ```bash
   npm run electron
   ```

4. Build Electron desktop app:
   ```bash
   npm run electron:build   # All platforms
   npm run electron:build:mac   # macOS
   npm run electron:build:win    # Windows
   ```

### Adding New Features

1. **New Resource Type**: Add to `ResourceType` enum in `types.ts`, update `getResourceTypeFromFile()` in `App.tsx`, and add icon/color in `constants.ts`

2. **New Dialog**: Create component in `components/`, add state in `App.tsx`, include in render

3. **New View Mode**: Add to `ViewMode` enum, create component, add to view switcher in `App.tsx`

4. **New Storage Backend**: Create service in `services/`, add configuration UI, update `storageService.ts` to switch modes

### Internationalization (i18n)

- Translations are in `services/i18n.ts`
- Currently supports English (`en`) and Chinese (`zh_CN`)
- Use `t(key)` function for translations
- Use `formatDate()` and `formatRelativeTime()` for date formatting

### Electron Integration

- Main process: `electron/main.js`
- Preload script: `electron/preload.js`
- Build config: `package.json` -> `build` section
- Icons: Place in `public/` folder (required for packaging)

## Tech Stack

- **Framework**: React 19 + TypeScript
- **Build Tool**: Vite 6
- **Styling**: Tailwind CSS
- **Icons**: Google Material Symbols
- **Backend**: Supabase
- **Desktop**: Electron + electron-builder
- **i18n**: Custom implementation

## Security Notes

- Supabase anonKey is safe to expose (RLS protects data)
- All sensitive Electron APIs exposed through contextBridge
- File operations use secure dialogs
- Token caching reduces API calls

## Code Style

- Use TypeScript for all new files
- Follow React functional component patterns
- Use Tailwind CSS for styling (macOS dark theme)
- Keep components focused and composable
- Use proper TypeScript interfaces for props
